<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Study Circle</title>
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
<div class="container">

  <!-- Header -->
  <header class="header">
    <div class="logo-row">
      <div class="logo-icon">SC</div>
      <div class="logo-text">
        <span class="logo-name">Study Circle</span>
        <span class="logo-sub">Canvas Sync</span>
      </div>
      <button class="gear-btn" id="gearBtn" title="Settings">&#9881;</button>
    </div>
  </header>

  <!-- Status area — populated by JS (checklist or connected dots) -->
  <div id="statusArea"></div>

  <!-- Sync button — always present, disabled until configured -->
  <button id="syncBtn" class="btn-primary" disabled>Sync Now</button>
  <p id="lastSync" class="last-sync"></p>

  <!-- Progress -->
  <div id="progressSection" hidden>
    <div class="progress-bar-track"><div class="progress-bar-fill" id="progressFill"></div></div>
    <p class="progress-label" id="progressLabel"></p>
  </div>

  <!-- Result -->
  <div id="resultSection" hidden>
    <div class="result-grid">
      <div class="result-item"><span class="result-num" id="rCourses">0</span><span class="result-lbl">courses</span></div>
      <div class="result-item"><span class="result-num" id="rAssignments">0</span><span class="result-lbl">assignments</span></div>
      <div class="result-item"><span class="result-num" id="rModules">0</span><span class="result-lbl">modules</span></div>
    </div>
    <p class="result-note" id="resultNote"></p>
  </div>

  <!-- Error -->
  <div id="errorSection" hidden>
    <p class="error-text" id="errorText"></p>
  </div>

  <!-- Course picker overlay -->
  <section class="course-picker" id="coursePicker" style="display:none">
    <div class="settings-header">
      <span class="settings-title">Select Courses</span>
    </div>
    <p class="picker-sub">Choose which courses to import into Study Circle.</p>
    <div class="picker-controls">
      <button class="btn-text" id="selectAllBtn">Select all</button>
      <span class="picker-sep">·</span>
      <button class="btn-text" id="selectNoneBtn">Clear</button>
    </div>
    <div id="courseList" class="course-list"></div>
    <div class="settings-footer">
      <button id="importBtn" class="btn-primary btn-sm">Import Selected</button>
      <button id="cancelPickerBtn" class="btn-danger-link">Cancel</button>
    </div>
  </section>

  <!-- Settings overlay -->
  <section class="settings-panel" id="settingsPanel" style="display:none">
    <div class="settings-header">
      <span class="settings-title">Settings</span>
      <button class="close-btn" id="closeSettings">✕</button>
    </div>

    <div class="field">
      <label class="field-label">Canvas URL</label>
      <input type="text" id="canvasUrl" class="field-input" placeholder="canvas.cornell.edu" spellcheck="false" autocomplete="off" />
      <span class="field-hint">Your school's Canvas domain (no https://)</span>
    </div>

    <div class="field">
      <label class="field-label">Study Circle URL</label>
      <input type="text" id="scUrl" class="field-input" placeholder="your-app.vercel.app" spellcheck="false" autocomplete="off" />
      <span class="field-hint">Your deployed app domain (no https://)</span>
    </div>

    <div class="field" id="tokenField">
      <label class="field-label">API Token</label>
      <input type="password" id="apiToken" class="field-input" placeholder="Paste token from Study Circle → Settings" autocomplete="off" />
      <span class="field-hint">Generate in Study Circle → Settings</span>
    </div>
    <div id="tokenSetRow" hidden>
      <span class="token-set-label">✓ Token connected</span>
      <button class="btn-text" id="replaceTokenBtn">Replace</button>
    </div>

    <div class="field-row-toggle">
      <div>
        <label class="field-label">Daily auto-sync</label>
        <span class="field-hint">Sync once a day when Canvas is open</span>
      </div>
      <label class="toggle">
        <input type="checkbox" id="autoSync" />
        <span class="toggle-slider"></span>
      </label>
    </div>

    <div class="settings-footer">
      <button id="saveSettings" class="btn-primary btn-sm">Save</button>
      <span id="saveConfirm" hidden class="save-confirm">Saved!</span>
      <button id="revokeBtn" hidden class="btn-danger-link">Disconnect</button>
    </div>
  </section>

</div>
<script src="popup.js"></script>
</body>
</html>
